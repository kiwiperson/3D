THREE.PDBLoader=function(e){THREE.Loader.call(this,e)},THREE.PDBLoader.prototype=new THREE.Loader,THREE.PDBLoader.prototype.constructor=THREE.PDBLoader,THREE.PDBLoader.prototype.supr=THREE.Loader.prototype,THREE.PDBLoader.prototype.load=function(e,t){var n,r=this;this.onLoadStart(),this.loadAjaxPDB(this,e,t)},THREE.PDBLoader.prototype.loadAjaxPDB=function(e,t,n,r){var i=new XMLHttpRequest,s=0;i.onreadystatechange=function(){if(i.readyState===i.DONE)if(i.status===200||i.status===0){if(i.responseText){var o=e.parsePDB(i.responseText);e.createModel(o,n)}else console.warn("THREE.PDBLoader: ["+t+"] seems to be unreachable or file there is empty");e.onLoadComplete()}else console.error("THREE.PDBLoader: Couldn't load ["+t+"] ["+i.status+"]");else i.readyState===i.LOADING?r&&(s===0&&(s=i.getResponseHeader("Content-Length")),r({total:s,loaded:i.responseText.length})):i.readyState===i.HEADERS_RECEIVED&&(s=i.getResponseHeader("Content-Length"))},i.open("GET",t,!0),i.overrideMimeType&&i.overrideMimeType("text/plain; charset=x-user-defined"),i.setRequestHeader("Content-Type","text/plain"),i.send(null)},THREE.PDBLoader.prototype.parsePDB=function(e){function t(e){return e.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function n(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}function r(e,t){return"s"+Math.min(e,t)+"e"+Math.max(e,t)}function i(e,t){var n=parseInt(l[v].substr(e,t));if(n){var i=r(g,n);f[i]==undefined&&(u.push([g-1,n-1,1]),f[i]=u.length-1)}}var s={h:[255,255,255],he:[217,255,255],li:[204,128,255],be:[194,255,0],b:[255,181,181],c:[144,144,144],n:[48,80,248],o:[255,13,13],f:[144,224,80],ne:[179,227,245],na:[171,92,242],mg:[138,255,0],al:[191,166,166],si:[240,200,160],p:[255,128,0],s:[255,255,48],cl:[31,240,31],ar:[128,209,227],k:[143,64,212],ca:[61,255,0],sc:[230,230,230],ti:[191,194,199],v:[166,166,171],cr:[138,153,199],mn:[156,122,199],fe:[224,102,51],co:[240,144,160],ni:[80,208,80],cu:[200,128,51],zn:[125,128,176],ga:[194,143,143],ge:[102,143,143],as:[189,128,227],se:[255,161,0],br:[166,41,41],kr:[92,184,209],rb:[112,46,176],sr:[0,255,0],y:[148,255,255],zr:[148,224,224],nb:[115,194,201],mo:[84,181,181],tc:[59,158,158],ru:[36,143,143],rh:[10,125,140],pd:[0,105,133],ag:[192,192,192],cd:[255,217,143],"in":[166,117,115],sn:[102,128,128],sb:[158,99,181],te:[212,122,0],i:[148,0,148],xe:[66,158,176],cs:[87,23,143],ba:[0,201,0],la:[112,212,255],ce:[255,255,199],pr:[217,255,199],nd:[199,255,199],pm:[163,255,199],sm:[143,255,199],eu:[97,255,199],gd:[69,255,199],tb:[48,255,199],dy:[31,255,199],ho:[0,255,156],er:[0,230,117],tm:[0,212,82],yb:[0,191,56],lu:[0,171,36],hf:[77,194,255],ta:[77,166,255],w:[33,148,214],re:[38,125,171],os:[38,102,150],ir:[23,84,135],pt:[208,208,224],au:[255,209,35],hg:[184,184,208],tl:[166,84,77],pb:[87,89,97],bi:[158,79,181],po:[171,92,0],at:[117,79,69],rn:[66,130,150],fr:[66,0,102],ra:[0,125,0],ac:[112,171,250],th:[0,186,255],pa:[0,161,255],u:[0,143,255],np:[0,128,255],pu:[0,107,255],am:[84,92,242],cm:[120,92,227],bk:[138,79,227],cf:[161,54,212],es:[179,31,212],fm:[179,31,186],md:[179,13,166],no:[189,13,135],lr:[199,0,102],rf:[204,0,89],db:[209,0,79],sg:[217,0,69],bh:[224,0,56],hs:[230,0,46],mt:[235,0,38],ds:[235,0,38],rg:[235,0,38],cn:[235,0,38],uut:[235,0,38],uuq:[235,0,38],uup:[235,0,38],uuh:[235,0,38],uus:[235,0,38],uuo:[235,0,38]},o=[],u=[],a={},f={},l=e.split("\n"),c,h,p,d;for(var v=0,m=l.length;v<m;++v)if(l[v].substr(0,4)=="ATOM"||l[v].substr(0,6)=="HETATM")c=parseFloat(l[v].substr(30,7)),h=parseFloat(l[v].substr(38,7)),p=parseFloat(l[v].substr(46,7)),d=t(l[v].substr(76,2)).toLowerCase(),d==""&&(d=t(l[v].substr(12,2)).toLowerCase()),o.push([c,h,p,s[d],n(d)]),a[d]==undefined?a[d]=1:a[d]+=1;else if(l[v].substr(0,6)=="CONECT"){var g=parseInt(l[v].substr(6,5));i(11,5),i(16,5),i(21,5),i(26,5)}return{ok:!0,atoms:o,bonds:u,histogram:a}},THREE.PDBLoader.prototype.createModel=function(e,t){var n=this,r=new THREE.Geometry,i=new THREE.Geometry;r.elements=[];var s=e.atoms,o=e.bonds;for(var u=0;u<s.length;u++){var a=s[u],f=a[0],l=a[1],c=a[2],h=new THREE.Vector3(f,l,c);r.vertices.push(h);var p=a[3][0]/255,d=a[3][1]/255,v=a[3][2]/255,m=new THREE.Color;m.setRGB(p,d,v),r.colors.push(m),r.elements.push(a[4])}for(var u=0;u<o.length;u++){var g=o[u],y=g[0],b=g[1],w=r.vertices[y],E=r.vertices[b];i.vertices.push(w.clone()),i.vertices.push(E.clone())}t(r,i)};