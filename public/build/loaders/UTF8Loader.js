function getHttpRequest(e,t,n){var r={load:function(e){t(i,e)},progress:function(e){n(i,e)}},i=new XMLHttpRequest;addListeners(i,r),i.open("GET",e,!0),i.send(null)}function getJsonRequest(e,t){getHttpRequest(e,function(e){t(JSON.parse(e.responseText))},function(){})}function addListeners(e,t){for(var n in t)e.addEventListener(n,t[n])}THREE.UTF8Loader=function(){},THREE.UTF8Loader.prototype.load=function(e,t,n){this.downloadModelJson(e,n,t)},THREE.UTF8Loader.BufferGeometryCreator=function(){},THREE.UTF8Loader.BufferGeometryCreator.prototype.create=function(e,t){var n=t.length/3,r=new THREE.BufferGeometry,i=new Float32Array(9*n),s=new Float32Array(9*n),o=new Float32Array(6*n),u,a,f,l,c,h,p,d,v=e.length,m=8;a=0,f=0;for(u=f;u<v;u+=m)l=e[u],c=e[u+1],h=e[u+2],i[a++]=l,i[a++]=c,i[a++]=h;a=0,f=3;for(u=f;u<v;u+=m)p=e[u],d=e[u+1],o[a++]=p,o[a++]=d;a=0,f=5;for(u=f;u<v;u+=m)l=e[u],c=e[u+1],h=e[u+2],s[a++]=l,s[a++]=c,s[a++]=h;var g=r.attributes;return g.index={itemSize:1,array:t,numItems:t.length},g.position={itemSize:3,array:i,numItems:i.length},g.normal={itemSize:3,array:s,numItems:s.length},g.uv={itemSize:2,array:o,numItems:o.length},r.offsets=[{start:0,count:t.length,index:0}],r.computeBoundingSphere(),r},THREE.UTF8Loader.GeometryCreator=function(){},THREE.UTF8Loader.GeometryCreator.prototype={create:function(e,t){var n=new THREE.Geometry;this.init_vertices(n,e,8,0);var r=this.init_uvs(e,8,3),i=this.init_normals(e,8,5);return this.init_faces(n,i,r,t),n.computeCentroids(),n.computeFaceNormals(),n},init_vertices:function(e,t,n,r){var i,s,o,u,a=t.length;for(i=r;i<a;i+=n)s=t[i],o=t[i+1],u=t[i+2],this.addVertex(e,s,o,u)},init_normals:function(e,t,n){var r=[],i,s,o,u,a=e.length;for(i=n;i<a;i+=t)s=e[i],o=e[i+1],u=e[i+2],r.push(s,o,u);return r},init_uvs:function(e,t,n){var r=[],i,s,o,u=e.length;for(i=n;i<u;i+=t)s=e[i],o=e[i+1],r.push(s,o);return r},init_faces:function(e,t,n,r){var i,s,o,u,a,f,l,c,h,p,d=r.length,v=0;for(i=0;i<d;i+=3)s=r[i],o=r[i+1],u=r[i+2],this.f3n(e,t,s,o,u,v,s,o,u),a=n[s*2],f=n[s*2+1],l=n[o*2],c=n[o*2+1],h=n[u*2],p=n[u*2+1],this.uv3(e.faceVertexUvs[0],a,f,l,c,h,p)},addVertex:function(e,t,n,r){e.vertices.push(new THREE.Vector3(t,n,r))},f3n:function(e,t,n,r,i,s,o,u,a){var f=t[o*3],l=t[o*3+1],c=t[o*3+2],h=t[u*3],p=t[u*3+1],d=t[u*3+2],v=t[a*3],m=t[a*3+1],g=t[a*3+2],y=new THREE.Vector3(f,l,c),b=new THREE.Vector3(h,p,d),w=new THREE.Vector3(v,m,g);e.faces.push(new THREE.Face3(n,r,i,[y,b,w],null,s))},uv3:function(e,t,n,r,i,s,o){var u=[];u.push(new THREE.Vector2(t,n)),u.push(new THREE.Vector2(r,i)),u.push(new THREE.Vector2(s,o)),e.push(u)}};var DEFAULT_DECODE_PARAMS={decodeOffsets:[-4095,-4095,-4095,0,0,-511,-511,-511],decodeScales:[1/8191,1/8191,1/8191,1/1023,1/1023,1/1023,1/1023,1/1023]};THREE.UTF8Loader.prototype.decompressAttribsInner_=function(e,t,n,r,i,s,o,u){var a=0;for(var f=t;f<n;f++){var l=e.charCodeAt(f);a+=l>>1^-(l&1),r[i]=u*(a+o),i+=s}},THREE.UTF8Loader.prototype.decompressIndices_=function(e,t,n,r,i){var s=0;for(var o=0;o<n;o++){var u=e.charCodeAt(t++);r[i++]=s-u,u===0&&s++}},THREE.UTF8Loader.prototype.decompressAABBs_=function(e,t,n,r,i){var s=6*n,o=t+s,u=0,a=new Float32Array(s);for(var f=t;f<o;f+=6){var l=e.charCodeAt(f+0)+r[0],c=e.charCodeAt(f+1)+r[1],h=e.charCodeAt(f+2)+r[2],p=e.charCodeAt(f+3)+1>>1,d=e.charCodeAt(f+4)+1>>1,v=e.charCodeAt(f+5)+1>>1;a[u++]=i[0]*(l+p),a[u++]=i[1]*(c+d),a[u++]=i[2]*(h+v),a[u++]=i[0]*p,a[u++]=i[1]*d,a[u++]=i[2]*v}return a},THREE.UTF8Loader.prototype.decompressMesh=function(e,t,n,r,i,s){var o=n.decodeScales.length,u=n.decodeOffsets,a=n.decodeScales,f=t.attribRange[0],l=t.attribRange[1],c=f,h=new Float32Array(o*l);for(var p=0;p<o;p++){var d=c+l,v=a[p];v&&this.decompressAttribsInner_(e,c,d,h,p,o,u[p],v),c=d}var m=t.indexRange[0],g=3*t.indexRange[1],y=new Uint16Array(g);this.decompressIndices_(e,c,g,y,0);var b=undefined,w=t.bboxes;w&&(b=this.decompressAABBs_(e,w,t.names.length,u,a)),s(r,i,h,y,b,t)},THREE.UTF8Loader.prototype.copyAttrib=function(e,t,n,r){for(var i=0;i<e;i++)n[i]=t[e*r+i]},THREE.UTF8Loader.prototype.decodeAttrib2=function(e,t,n,r,i,s,o,u,a,f){for(var l=0;l<5;l++){var c=e.charCodeAt(i+s*l+f),h=c>>1^-(c&1);a[l]+=h,u[t*f+l]=a[l],o[t*f+l]=r[l]*(a[l]+n[l])}},THREE.UTF8Loader.prototype.accumulateNormal=function(e,t,n,r,i){var s=r[8*e],o=r[8*e+1],u=r[8*e+2],a=r[8*t],f=r[8*t+1],l=r[8*t+2],c=r[8*n],h=r[8*n+1],p=r[8*n+2];a-=s,f-=o,l-=u,c-=s,h-=o,p-=u,s=f*p-l*h,o=l*c-a*p,u=a*h-f*c,i[3*e]+=s,i[3*e+1]+=o,i[3*e+2]+=u,i[3*t]+=s,i[3*t+1]+=o,i[3*t+2]+=u,i[3*n]+=s,i[3*n+1]+=o,i[3*n+2]+=u},THREE.UTF8Loader.prototype.decompressMesh2=function(e,t,n,r,i,s){var o=96,u=n.decodeScales.length,a=n.decodeOffsets,f=n.decodeScales,l=t.attribRange[0],c=t.attribRange[1],h=t.codeRange[0],p=t.codeRange[1],d=3*t.codeRange[2],v=new Uint16Array(d),m=new Int32Array(3*c),g=new Uint16Array(u),y=new Uint16Array(u*c),b=new Float32Array(u*c),w=0,E=0;for(var S=0;S<d;S+=3){var x=e.charCodeAt(h++),T=Math.min(S,o);if(x<T){var N=x%3,C=S-(x-N),k,L,A;switch(N){case 0:k=v[C+2],L=v[C+1],A=v[C+0];break;case 1:k=v[C+0],L=v[C+2],A=v[C+1];break;case 2:k=v[C+1],L=v[C+0],A=v[C+2]}v[E++]=k,v[E++]=L,x=e.charCodeAt(h++);var O=w-x;v[E++]=O;if(x===0){for(var M=0;M<5;M++){var _=e.charCodeAt(l+c*M+w),D=(_>>1^-(_&1))+y[u*k+M]+y[u*L+M]-y[u*A+M];g[M]=D,y[u*w+M]=D,b[u*w+M]=f[M]*(D+a[M])}w++}else this.copyAttrib(u,y,g,O);this.accumulateNormal(k,L,O,y,m)}else{var P=w-(x-T);v[E++]=P,x===T?this.decodeAttrib2(e,u,a,f,l,c,b,y,g,w++):this.copyAttrib(u,y,g,P),x=e.charCodeAt(h++);var H=w-x;v[E++]=H,x===0?this.decodeAttrib2(e,u,a,f,l,c,b,y,g,w++):this.copyAttrib(u,y,g,H),x=e.charCodeAt(h++);var B=w-x;v[E++]=B;if(x===0){for(var M=0;M<5;M++)g[M]=(y[u*P+M]+y[u*H+M])/2;this.decodeAttrib2(e,u,a,f,l,c,b,y,g,w++)}else this.copyAttrib(u,y,g,B);this.accumulateNormal(P,H,B,y,m)}}for(var S=0;S<c;S++){var j=m[3*S],F=m[3*S+1],I=m[3*S+2],q=511/Math.sqrt(j*j+F*F+I*I),R=e.charCodeAt(l+5*c+S),U=e.charCodeAt(l+6*c+S),z=e.charCodeAt(l+7*c+S);b[u*S+5]=q*j+(R>>1^-(R&1)),b[u*S+6]=q*F+(U>>1^-(U&1)),b[u*S+7]=q*I+(z>>1^-(z&1))}s(r,i,b,v,undefined,t)},THREE.UTF8Loader.prototype.downloadMesh=function(e,t,n,r,i){function u(e,u){while(o<n.length){var a=n[o],f=a.indexRange;if(f){var l=f[0]+3*f[1];if(e.responseText.length<l)break;s.decompressMesh(e.responseText,a,r,t,o,i)}else{var c=a.codeRange,l=c[0]+c[1];if(e.responseText.length<l)break;s.decompressMesh2(e.responseText,a,r,t,o,i)}++o}}var s=this,o=0;getHttpRequest(e,function(e,t){(e.status===200||e.status===0)&&u(e,t)},u)},THREE.UTF8Loader.prototype.downloadMeshes=function(e,t,n,r){for(var i in t){var s=t[i];this.downloadMesh(e+i,i,s,n,r)}},THREE.UTF8Loader.prototype.createMeshCallback=function(e,t,n){var r=0,i=0,s={},o={},u={},a=t.urls;for(var f in a)s[f]=a[f].length,o[f]=0,i++,u[f]=new THREE.Object3D;var l=new THREE.Object3D,c=new THREE.MTLLoader.MaterialCreator(e,t.options);c.setMaterials(t.materials),c.preload();var h=new THREE.UTF8Loader.GeometryCreator,p=new THREE.UTF8Loader.BufferGeometryCreator,d=function(e,a,f,d,v,m){var g=t.options.useBuffers!==undefined?t.options.useBuffers:!0;if(g)var y=p.create(f,d);else var y=h.create(f,d);var b=c.create(m.material),w=new THREE.Mesh(y,b);u[e].add(w),o[e]++,o[e]===s[e]&&(r++,l.add(u[e]),r===i&&n(l))};return d},THREE.UTF8Loader.prototype.downloadModel=function(e,t,n,r){var i=this.createMeshCallback(t,n,r);this.downloadMeshes(e,n.urls,n.decodeParams,i)},THREE.UTF8Loader.prototype.downloadModelJson=function(e,t,n){getJsonRequest(e,function(r){r.decodeParams||(t&&t.decodeParams?r.decodeParams=t.decodeParams:r.decodeParams=DEFAULT_DECODE_PARAMS),r.options=t;var i=e.substr(0,e.lastIndexOf("/")+1),s=i;t&&t.geometryBase&&(i=t.geometryBase,i.charAt(i.length-1)!=="/"&&(i+="/")),t&&t.materialBase&&(s=t.materialBase,s.charAt(s.length-1)!=="/"&&(s+="/")),this.downloadModel(i,s,r,n)}.bind(this))};