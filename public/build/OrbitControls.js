THREE.OrbitControls=function(e,t){function y(){return 2*Math.PI/60/60*n.autoRotateSpeed}function b(){return Math.pow(.95,n.userZoomSpeed)}function w(e){if(!n.userRotate)return;e.preventDefault(),e.button===0?(m=v.ROTATE,s.set(e.clientX,e.clientY)):e.button===1?(m=v.ZOOM,a.set(e.clientX,e.clientY)):e.button===2&&(m=v.PAN),document.addEventListener("mousemove",E,!1),document.addEventListener("mouseup",S,!1)}function E(e){e.preventDefault();if(m===v.ROTATE)o.set(e.clientX,e.clientY),u.subVectors(o,s),n.rotateLeft(2*Math.PI*u.x/i*n.userRotateSpeed),n.rotateUp(2*Math.PI*u.y/i*n.userRotateSpeed),s.copy(o);else if(m===v.ZOOM)f.set(e.clientX,e.clientY),l.subVectors(f,a),l.y>0?n.zoomIn():n.zoomOut(),a.copy(f);else if(m===v.PAN){var t=e.movementX||e.mozMovementX||e.webkitMovementX||0,r=e.movementY||e.mozMovementY||e.webkitMovementY||0;n.pan(new THREE.Vector3(-t,r,0))}}function S(e){if(!n.userRotate)return;document.removeEventListener("mousemove",E,!1),document.removeEventListener("mouseup",S,!1),m=v.NONE}function x(e){if(!n.userZoom)return;var t=0;e.wheelDelta?t=e.wheelDelta:e.detail&&(t=-e.detail),t>0?n.zoomOut():n.zoomIn()}function T(e){if(!n.userPan)return;switch(e.keyCode){case n.keys.UP:n.pan(new THREE.Vector3(0,1,0));break;case n.keys.BOTTOM:n.pan(new THREE.Vector3(0,-1,0));break;case n.keys.LEFT:n.pan(new THREE.Vector3(-1,0,0));break;case n.keys.RIGHT:n.pan(new THREE.Vector3(1,0,0))}}THREE.EventDispatcher.call(this),this.object=e,this.domElement=t!==undefined?t:document,this.center=new THREE.Vector3,this.userZoom=!0,this.userZoomSpeed=1,this.userRotate=!0,this.userRotateSpeed=1,this.userPan=!0,this.userPanSpeed=2,this.autoRotate=!1,this.autoRotateSpeed=2,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minDistance=0,this.maxDistance=Infinity,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40};var n=this,r=1e-6,i=1800,s=new THREE.Vector2,o=new THREE.Vector2,u=new THREE.Vector2,a=new THREE.Vector2,f=new THREE.Vector2,l=new THREE.Vector2,c=0,h=0,p=1,d=new THREE.Vector3,v={NONE:-1,ROTATE:0,ZOOM:1,PAN:2},m=v.NONE,g={type:"change"};this.rotateLeft=function(e){e===undefined&&(e=y()),h-=e},this.rotateRight=function(e){e===undefined&&(e=y()),h+=e},this.rotateUp=function(e){e===undefined&&(e=y()),c-=e},this.rotateDown=function(e){e===undefined&&(e=y()),c+=e},this.zoomIn=function(e){e===undefined&&(e=b()),p/=e},this.zoomOut=function(e){e===undefined&&(e=b()),p*=e},this.pan=function(e){e.transformDirection(this.object.matrix),e.multiplyScalar(n.userPanSpeed),this.object.position.add(e),this.center.add(e)},this.update=function(){var e=this.object.position,t=e.clone().sub(this.center),n=Math.atan2(t.x,t.z),i=Math.atan2(Math.sqrt(t.x*t.x+t.z*t.z),t.y);this.autoRotate&&this.rotateLeft(y()),n+=h,i+=c,i=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,i)),i=Math.max(r,Math.min(Math.PI-r,i));var s=t.length()*p;s=Math.max(this.minDistance,Math.min(this.maxDistance,s)),t.x=s*Math.sin(i)*Math.sin(n),t.y=s*Math.cos(i),t.z=s*Math.sin(i)*Math.cos(n),e.copy(this.center).add(t),this.object.lookAt(this.center),h=0,c=0,p=1,d.distanceTo(this.object.position)>0&&(this.dispatchEvent(g),d.copy(this.object.position))},this.domElement.addEventListener("contextmenu",function(e){e.preventDefault()},!1),this.domElement.addEventListener("mousedown",w,!1),this.domElement.addEventListener("mousewheel",x,!1),this.domElement.addEventListener("DOMMouseScroll",x,!1),this.domElement.addEventListener("keydown",T,!1)};