THREE.OrbitControls=function(e,t){function E(){return 2*Math.PI/60/60*n.autoRotateSpeed}function S(){return Math.pow(.95,n.zoomSpeed)}function x(e){if(n.enabled===!1)return;e.preventDefault();if(e.button===0){if(n.noRotate===!0)return;b=y.ROTATE,i.set(e.clientX,e.clientY)}else if(e.button===1){if(n.noZoom===!0)return;b=y.DOLLY,l.set(e.clientX,e.clientY)}else if(e.button===2){if(n.noPan===!0)return;b=y.PAN,u.set(e.clientX,e.clientY)}document.addEventListener("mousemove",T,!1),document.addEventListener("mouseup",N,!1)}function T(e){if(n.enabled===!1)return;e.preventDefault();if(b===y.ROTATE){if(n.noRotate===!0)return;s.set(e.clientX,e.clientY),o.subVectors(s,i),n.rotateLeft(2*Math.PI*o.x/n.domElement.width*n.rotateSpeed),n.rotateUp(2*Math.PI*o.y/n.domElement.height*n.rotateSpeed),i.copy(s)}else if(b===y.DOLLY){if(n.noZoom===!0)return;c.set(e.clientX,e.clientY),h.subVectors(c,l),h.y>0?n.dollyIn():n.dollyOut(),l.copy(c)}else if(b===y.PAN){if(n.noPan===!0)return;a.set(e.clientX,e.clientY),f.subVectors(a,u),n.pan(f),u.copy(a)}}function N(){if(n.enabled===!1)return;document.removeEventListener("mousemove",T,!1),document.removeEventListener("mouseup",N,!1),b=y.NONE}function C(e){if(n.enabled===!1)return;if(n.noZoom===!0)return;var t=0;e.wheelDelta?t=e.wheelDelta:e.detail&&(t=-e.detail),t>0?n.dollyOut():n.dollyIn()}function k(e){if(n.enabled===!1)return;if(n.noKeys===!0)return;if(n.noPan===!0)return;switch(e.keyCode){case n.keys.UP:n.pan(new THREE.Vector2(0,1));break;case n.keys.BOTTOM:n.pan(new THREE.Vector2(0,-1));break;case n.keys.LEFT:n.pan(new THREE.Vector2(1,0));break;case n.keys.RIGHT:n.pan(new THREE.Vector2(-1,0))}}function L(e){if(n.enabled===!1)return;switch(e.touches.length){case 1:if(n.noRotate===!0)return;b=y.TOUCH_ROTATE,i.set(e.touches[0].pageX,e.touches[0].pageY);break;case 2:if(n.noZoom===!0)return;b=y.TOUCH_DOLLY;var t=e.touches[0].pageX-e.touches[1].pageX,r=e.touches[0].pageY-e.touches[1].pageY,s=Math.sqrt(t*t+r*r);l.set(0,s);break;case 3:if(n.noPan===!0)return;b=y.TOUCH_PAN,u.set(e.touches[0].pageX,e.touches[0].pageY);break;default:b=y.NONE}}function A(e){if(n.enabled===!1)return;e.preventDefault(),e.stopPropagation();switch(e.touches.length){case 1:if(n.noRotate===!0)return;if(b!==y.TOUCH_ROTATE)return;s.set(e.touches[0].pageX,e.touches[0].pageY),o.subVectors(s,i),n.rotateLeft(2*Math.PI*o.x/n.domElement.width*n.rotateSpeed),n.rotateUp(2*Math.PI*o.y/n.domElement.height*n.rotateSpeed),i.copy(s);break;case 2:if(n.noZoom===!0)return;if(b!==y.TOUCH_DOLLY)return;var t=e.touches[0].pageX-e.touches[1].pageX,r=e.touches[0].pageY-e.touches[1].pageY,p=Math.sqrt(t*t+r*r);c.set(0,p),h.subVectors(c,l),h.y>0?n.dollyOut():n.dollyIn(),l.copy(c);break;case 3:if(n.noPan===!0)return;if(b!==y.TOUCH_PAN)return;a.set(e.touches[0].pageX,e.touches[0].pageY),f.subVectors(a,u),n.pan(f),u.copy(a);break;default:b=y.NONE}}function O(){if(n.enabled===!1)return;b=y.NONE}THREE.EventDispatcher.call(this),this.object=e,this.domElement=t!==undefined?t:document,this.enabled=!0,this.target=new THREE.Vector3,this.center=this.target,this.noZoom=!1,this.zoomSpeed=1,this.noRotate=!1,this.rotateSpeed=1,this.noPan=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minDistance=0,this.maxDistance=Infinity,this.noKeys=!1,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40};var n=this,r=1e-6,i=new THREE.Vector2,s=new THREE.Vector2,o=new THREE.Vector2,u=new THREE.Vector2,a=new THREE.Vector2,f=new THREE.Vector2,l=new THREE.Vector2,c=new THREE.Vector2,h=new THREE.Vector2,p=0,d=0,v=1,m=new THREE.Vector3,g=new THREE.Vector3,y={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},b=y.NONE,w={type:"change"};this.rotateLeft=function(e){e===undefined&&(e=E()),d-=e},this.rotateUp=function(e){e===undefined&&(e=E()),p-=e},this.panLeft=function(e){var t=new THREE.Vector3,n=this.object.matrix.elements;t.set(n[0],n[1],n[2]),t.multiplyScalar(-e),m.add(t)},this.panUp=function(e){var t=new THREE.Vector3,n=this.object.matrix.elements;t.set(n[4],n[5],n[6]),t.multiplyScalar(e),m.add(t)},this.pan=function(e){if(n.object.fov!==undefined){var t=n.object.position,r=t.clone().sub(n.target),i=r.length();i*=Math.tan(n.object.fov/2*Math.PI/180),n.panLeft(2*e.x*i/n.domElement.height),n.panUp(2*e.y*i/n.domElement.height)}else n.object.top!==undefined?(n.panLeft(e.x*(n.object.right-n.object.left)/n.domElement.width),n.panUp(e.y*(n.object.top-n.object.bottom)/n.domElement.height)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.")},this.dollyIn=function(e){e===undefined&&(e=S()),v/=e},this.dollyOut=function(e){e===undefined&&(e=S()),v*=e},this.update=function(){var e=this.object.position,t=e.clone().sub(this.target),n=Math.atan2(t.x,t.z),i=Math.atan2(Math.sqrt(t.x*t.x+t.z*t.z),t.y);this.autoRotate&&this.rotateLeft(E()),n+=d,i+=p,i=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,i)),i=Math.max(r,Math.min(Math.PI-r,i));var s=t.length()*v;s=Math.max(this.minDistance,Math.min(this.maxDistance,s)),this.target.add(m),t.x=s*Math.sin(i)*Math.sin(n),t.y=s*Math.cos(i),t.z=s*Math.sin(i)*Math.cos(n),e.copy(this.target).add(t),this.object.lookAt(this.target),d=0,p=0,v=1,m.set(0,0,0),g.distanceTo(this.object.position)>0&&(this.dispatchEvent(w),g.copy(this.object.position))},this.domElement.addEventListener("contextmenu",function(e){e.preventDefault()},!1),this.domElement.addEventListener("mousedown",x,!1),this.domElement.addEventListener("mousewheel",C,!1),this.domElement.addEventListener("DOMMouseScroll",C,!1),this.domElement.addEventListener("keydown",k,!1),this.domElement.addEventListener("touchstart",L,!1),this.domElement.addEventListener("touchend",O,!1),this.domElement.addEventListener("touchmove",A,!1)},THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype);